<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Basics</title>
<meta name="generator" content="Org mode">
<meta name="author" content="George Kontsevich">
<meta name="description" content="Basics in Stats using Octave/MATLAB"
>
<link rel="stylesheet" type="text/css" href="../web/worg.css" />
<link rel="shortcut icon" href="../web/panda.svg" type="image/x-icon">
</head>
<body>
<div id="content">
<h1 class="title">Basics</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orge56c4c6">Intro</a></li>
<li><a href="#orgf644258">Continious random variables</a></li>
<li><a href="#org0754b48">Probability density functions (PDFs)</a>
<ul>
<li><a href="#org670dac9">Example: Normal distribution</a></li>
<li><a href="#org725d62c">Probability densities</a></li>
<li><a href="#orgfb8cbcc">Estimating a PDF</a></li>
<li><a href="#org7fd192e">Example: Estimating the Normal</a></li>
</ul>
</li>
<li><a href="#org0332860">Descriptive statistics</a>
<ul>
<li>
<ul>
<li><a href="#orgcbdc08e">Expected Value/Mean</a></li>
<li><a href="#orgdb32724">Variance</a></li>
<li><a href="#org550c0e2">Standard deviation</a></li>
</ul>
</li>
<li><a href="#org3d3d7b6">Estimating the Normal's descriptive statistics</a>
<ul>
<li><a href="#org5446f40">Mean of the Normal</a></li>
<li><a href="#orgae0c6b7">Standard deviation of the normal</a></li>
</ul>
</li>
<li><a href="#org8cca352">SigFigs</a></li>
<li><a href="#orgc86fa4c">Adding two random variables</a>
<ul>
<li><a href="#orgd71387b">Expected Value</a></li>
<li><a href="#org23d4c7d">Variance</a></li>
<li><a href="#org3d2e530">Standard Deviation</a></li>
<li><a href="#orgac85597">SigFigs</a></li>
<li><a href="#org02141c6">Example: Standard deviation of the mean (SDOM)</a></li>
</ul>
</li>
<li><a href="#org03fa617">Multiplying two random variables</a>
<ul>
<li><a href="#orgb3fd825">Expected Value</a></li>
<li><a href="#orge9fc430">Variance</a></li>
<li><a href="#org0f8a4db">Standard Deviation</a></li>
<li><a href="#org9740439">SigFigs</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org7da44e5">Other Topics</a>
<ul>
<li><a href="#orgc3edccf">Data Rejection</a>
<ul>
<li><a href="#org1d95328">Chauvenet's Criterion</a></li>
</ul>
</li>
<li><a href="#orgd03facd">Weighted Average</a>
<ul>
<li><a href="#orgcc7c661">Mean</a></li>
<li><a href="#org97c2257">Standard Deviation</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#orgeae5882">End</a></li>
</ul>
</div>
</div>

<div id="outline-container-orge56c4c6" class="outline-2">
<h2 id="orge56c4c6">Intro</h2>
<div class="outline-text-2" id="text-orge56c4c6">
<p>
A digest of basic statistics from reading John Taylor's <i>An Introduction to Error Analysis: The Study of Uncertainties in Physical Measurements</i>
</p>

<p>
The book generally works "backwards": Starting from useful principles of working with uncertain values and then working through the justification and proofs. Since this is a quick digest and personal referesher/reference, the order is opposite of that presented in the book. When it makes sense I had inserted some MATLAB/Octave code to demonstrate things
</p>
</div>
</div>
<div id="outline-container-orgf644258" class="outline-2">
<h2 id="orgf644258">Continious random variables</h2>
<div class="outline-text-2" id="text-orgf644258">
<p>
Are variables that when measured give a value of infinite precision. So no number can be measured twice
</p>
</div>
</div>

<div id="outline-container-org0754b48" class="outline-2">
<h2 id="org0754b48">Probability density functions (PDFs)</h2>
<div class="outline-text-2" id="text-org0754b48">
<p>
Probability density functions (PDFs) are the basic functions that describe a continious random variable. The basic property of a PDF is that it can be integrated between any two value. The resulting value is the probability that your measurement will appear between the two values. Since each measurements yields <i>some</i> value, integrate between -&infin; and &infin; must be equal to 1 (ie. 100%). The condition places a constraint on which functions are valid PDFs.
</p>

<div class="org-src-container">
<pre class="src src-octave">plot_range <span style="color: #483d8b;">=</span> 5
sigma <span style="color: #483d8b;">=</span> 1
center <span style="color: #483d8b;">=</span> 3
tau <span style="color: #483d8b;">=</span> 3.5
t <span style="color: #483d8b;">=</span> [<span style="color: #483d8b;">-</span>10<span style="color: #483d8b;">*</span>plot_range<span style="color: #483d8b;">:</span>plot_range<span style="color: #483d8b;">/</span>100<span style="color: #483d8b;">:</span>plot_range]
plot(t<span style="color: #483d8b;">,</span>(1<span style="color: #483d8b;">/</span>tau)<span style="color: #483d8b;">*</span>exp(<span style="color: #483d8b;">-</span>t<span style="color: #483d8b;">/</span>tau))
<span style="color: #b22222;">%</span><span style="color: #b22222;">axis "off"</span>
hold on<span style="color: #483d8b;">;</span>
<span style="color: #b22222;">%</span><span style="color: #b22222;">integration_xs = [a:(plot_range/50):b]</span>
<span style="color: #b22222;">%</span><span style="color: #b22222;">area(integration_xs,normal_dist(integration_xs,center,sigma), "facecolor",[0.74 0.9 1.0])</span>
print <span style="color: #8b2252;">"-S720,160"</span> <span style="color: #8b2252;">"exponential.svg"</span>
hold off<span style="color: #483d8b;">;</span>
</pre>
</div>

<div class="figure">
<p><object type="image/svg+xml" data="./exponential.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>
</div>

<div id="outline-container-org670dac9" class="outline-3">
<h3 id="org670dac9">Example: Normal distribution</h3>
<div class="outline-text-3" id="text-org670dac9">
<p>
The most common PDF is the <i>normal distribution</i> and it'll serve as a frequent example
</p>

<blockquote>
<p>
[1/(&sigma;&radic;2&pi;)] * e<sup>([x-X<sub>center</sub>]<sup>2</sup>)/(2&sigma;<sup>2</sup>)</sup>
</p>
</blockquote>

<p>
It has two parameters, <b>&sigma;</b> and <b>X<sub>center</sub></b>. Other functions may have different parameters. As we will see later, in this case these two happen to correspond to the <i>mean</i> and <i>standard deviation</i>, but this won't be the case for all PDFs.
</p>

<div class="org-src-container">
<pre class="src src-octave"><span style="color: #a020f0;">function</span> [points] <span style="color: #483d8b;">=</span> <span style="color: #0000ff;">normal_dist</span>(xs<span style="color: #483d8b;">,</span> center<span style="color: #483d8b;">,</span> sigma)
  normalization_factor <span style="color: #483d8b;">=</span> 1<span style="color: #483d8b;">/</span>(sigma<span style="color: #483d8b;">*</span>sqrt(2<span style="color: #483d8b;">*</span>pi))
  points <span style="color: #483d8b;">=</span> normalization_factor <span style="color: #483d8b;">*</span> e<span style="color: #483d8b;">.^</span>(<span style="color: #483d8b;">-</span>((xs<span style="color: #483d8b;">-</span>center)<span style="color: #483d8b;">.^</span>2)<span style="color: #483d8b;">/</span>(2<span style="color: #483d8b;">*</span>sigma<span style="color: #483d8b;">^</span>2))
<span style="color: #a020f0;">end</span>
</pre>
</div>

<p>
We can plot it to see how it looks
</p>


<div class="figure">
<p><object type="image/svg+xml" data="./normal.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>
</div>
</div>

<div id="outline-container-org725d62c" class="outline-3">
<h3 id="org725d62c">Probability densities</h3>
<div class="outline-text-3" id="text-org725d62c">
<p>
Again, because the random variable is continious, no value can be measured twice. We can see this in the PDF as well. If we integrate around some point x<sub>0</sub>. The integral from <i>x<sub>0</sub></i> to <i>x<sub>0</sub>+&delta;x</i> will go to zero as <i>&delta;x</i> goes to zero. We know that for very small integrals we can approximate them with the area of the immediate rectangle
</p>


<div class="figure">
<p><object type="image/svg+xml" data="./prob-density.svg" class="org-svg">
Sorry, your browser does not support SVG.</object>
</p>
</div>


<p>
The size of the <i>&delta;x</i> isn't really important, but we can see that given a few points <i>x<sub>0</sub></i>, <i>x<sub>1</sub></i>, <i>x<sub>2</sub></i> .. etc.  we can use their equivalent <b>probability densities</b> <i>f(x<sub>0</sub>)</i>, <i>f(x<sub>1</sub>)</i>,  <i>f(x<sub>2</sub>)</i>, etc.  to say in effect that one was more likely than the other
</p>
</div>
</div>

<div id="outline-container-orgfb8cbcc" class="outline-3">
<h3 id="orgfb8cbcc">Estimating a PDF</h3>
<div class="outline-text-3" id="text-orgfb8cbcc">
<p>
Often in an experimental scenario we will get a series of measurements from which we woujld like to estimate a PDF. There is typically some meta information about the process that generated the values which tells you the general formula for the PDF.
</p>

<p>
We can guess parameters for the PDF and then generate probabilities that the values landed in the vicinity of each measurment. For each measurement, the probability of a measurement being in its vicinity is the area of its equivalent skinny rectangle: <i>f(x<sub>n</sub>)&delta;x</i>. And the cumulative probability of all the measurements landing where they did is just the product of the individual probabilities.
</p>
<blockquote>
<p>
f(x<sub>0</sub>) &delta;x &times; f(x<sub>1</sub>) &delta;x &times; f(x<sub>2</sub>) &delta;x &times; &hellip;
</p>
</blockquote>
<p>
This ofcourse is a tiny value, that gets smaller the smaller the <i>&delta;x</i> and the more measurements you make.
</p>

<p>
However the goal now is to adjust the PDF parameters so that this cumulative probability is maximized. Maximizing this product clearly doesn't depend on the value of <i>&delta;x</i> you've chosen, so we can remove those
</p>
<blockquote>
<p>
f(x<sub>0</sub>) &times; f(x<sub>1</sub>) &times; f(x<sub>2</sub>) &times; &hellip;
</p>
</blockquote>
<p>
As is most often the case, maximization is done by differentiation and setting the result to zero.
</p>
</div>
</div>

<div id="outline-container-org7fd192e" class="outline-3">
<h3 id="org7fd192e">Example: Estimating the Normal</h3>
<div class="outline-text-3" id="text-org7fd192e">
<p>
As an example, we can plug in the previously introduced <i>normal distribution</i> for the PDF <i>f(x)</i> and then assume some measurements <i>x<sub>0</sub></i> <i>x<sub>1</sub></i> <i>x<sub>2</sub></i>  .. 
We know the PDF equation:
</p>
<blockquote>
<p>
f(x) = [1/(&sigma;&radic;2&pi;)]  e<sup>([x-X<sub>center</sub>]<sup>2</sup>)/(2&sigma;<sup>2</sup>)</sup><br>
</p>
</blockquote>
<p>
and so the cumulative probability will be:
</p>
<blockquote>
<p>
f(x<sub>0</sub>)&times;f(x<sub>1</sub>)&times;f(x<sub>2</sub>)&times; .. <br>
[1/(&sigma;&radic;2&pi;)]<sup>n</sup>  e<sup>&sum; ([x<sub>i</sub>-X<sub>center</sub>]<sup>2</sup>)/(2&sigma;<sup>2</sup>)</sup>
</p>
</blockquote>
<p>
<i>X<sub>center</sub></i> and <i>&sigma;</i> are our two unknow parameters. We could now differentiate and solve to find the maximal value
</p>
</div>
</div>
</div>

<div id="outline-container-org0332860" class="outline-2">
<h2 id="org0332860">Descriptive statistics</h2>
<div class="outline-text-2" id="text-org0332860">
<p>
A very unusual effect of continious random variables is that we can often skip their probability distributions entirely and summerizing them with just the <i>mean</i> and <i>variance</i>
</p>
</div>

<div id="outline-container-orgcbdc08e" class="outline-4">
<h4 id="orgcbdc08e">Expected Value/Mean</h4>
<div class="outline-text-4" id="text-orgcbdc08e">
<p>
The expected value of a random variable is the "average" of the probability distribution. Usually written as <b>E[x]</b>. For continious functions this translates to the integral 
</p>
<blockquote>
<p>
E[x] = &int;f(u)&times;u   &hellip; <i>(from  -&infin; to &infin;)</i>
</p>
</blockquote>
<p>
(the notation is a bit confusing b/c <b>x</b> is a random variable and <b>u</b> is a possible value for <b>x</b> and <b>f(u)</b> is a probability density for that value)
</p>
</div>
</div>

<div id="outline-container-orgdb32724" class="outline-4">
<h4 id="orgdb32724">Variance</h4>
<div class="outline-text-4" id="text-orgdb32724">
<p>
The variance is a value to describe how much the random variable differs from its <i>expected value</i>
</p>
<blockquote>
<p>
Var[x]= E[(E[x]-x)<sup>2</sup>]
</p>
</blockquote>
<p>
The power-of-2 ensures that the you are integrating over positive values. If the expected value of the random variable is <b>0</b> then the variance is just <b>E[x<sup>2</sup>]</b> or <i>&int;(f(u))<sup>2</sup></i>
</p>
<dl class="org-dl">
<dt><b>TODO</b></dt><dd>Why not the absolute value? It's not just a mathematical convenience&#x2026; It has some numerical advantage (I just forget what it is)</dd>
</dl>
</div>
</div>

<div id="outline-container-org550c0e2" class="outline-4">
<h4 id="org550c0e2">Standard deviation</h4>
<div class="outline-text-4" id="text-org550c0e2">
<p>
The <i>standard deviation</i> is just the square root of the variance and denoted with <i>&sigma;</i>: 
</p>
<blockquote>
<p>
Var[x] = &sigma;<sub>x</sub><sup>2</sup>
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org3d3d7b6" class="outline-3">
<h3 id="org3d3d7b6">Estimating the Normal's descriptive statistics</h3>
<div class="outline-text-3" id="text-org3d3d7b6">
<p>
The Normal Distributions is a bit unusual in that the mean and standard deviation are parameters of the PDF. So when we differentiate and solve for the PDF that fits our measurements we automatically end up with the best estimates for the mean and variance
</p>
</div>
<div id="outline-container-org5446f40" class="outline-4">
<h4 id="org5446f40">Mean of the Normal</h4>
<div class="outline-text-4" id="text-org5446f40">
<p>
Finishing what we started before, we want to pick a <b>X<sub>center</sub></b> to maximize the cumulative probability of our measurements, which  was
</p>
<blockquote>
<p>
[1/(&sigma;&radic;2&pi;)]<sup>n</sup>  e<sup>&sum; ([x<sub>i</sub>-X<sub>center</sub>]<sup>2</sup>)/(2&sigma;<sup>2</sup>)</sup>
</p>
</blockquote>
<p>
Fortunately, even though the cumulative probability equation  a bit complicated, we only need to maximize the exponent part b/c everything else is not a function of <b>X<sub>center</sub></b>
</p>
<blockquote>
<p>
&sum; (x<sub>i</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sup>2</sup>)
</p>
</blockquote>
<p>
To find its maximum we differentiating and set equal to zero:
</p>
<blockquote>
<p>
&sum; (x<sub>i</sub>-X<sub>center</sub>) = 0
</p>
</blockquote>

<p>
Which gives us a 
</p>
<blockquote>
<p>
X<sub>center</sub> = &sum;x<sub>i</sub>/N
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgae0c6b7" class="outline-4">
<h4 id="orgae0c6b7">Standard deviation of the normal</h4>
<div class="outline-text-4" id="text-orgae0c6b7">
<p>
To estimate an optimal standard deviation <b>&sigma;</b> we follow the procedure as with the mean <b>X<sub>center</sub></b>. We differentiate with respect to <b>&sigma;</b> and then solve for when it's equal to zero. Unlike before, we can't just maximize the exponent part b/c in this case there is a <b>/sigma{}</b> in the factor in front as well as in the exponent. So we need to differentiate <i>by-parts</i>
</p>
<blockquote>
<p>
0 = d/d&sigma;  [1/(&sigma;&radic;2&pi;)]<sup>n</sup>  e<sup>&sum; ([x<sub>i</sub>-X<sub>center</sub>]<sup>2</sup>)/(2&sigma;<sup>2</sup>)</sup><br>
&sigma;<sub>best-estimate</sub> = &radic; (1/N) &sum;(x<sub>i</sub>-X<sub>center</sub>)<sup>2</sup>
</p>
</blockquote>
<p>
The next issue we see is that the solution for <b>&sigma;</b> is a function of <b>X<sub>center</sub></b> which we also don't know. The best we can do here is to subsitute in the best estimate we'd just found in the previous section:  <b>&sum;x<sub>i</sub>/N</b>
</p>

<p>
This unfortunately introducing a <i>bias</i>! <br>
</p>

<p>
The estimated mean is such that the measurments are situated "optimally" around it. The true mean, whatever it is, will be <i>guaranteed</i> to be worse relative to our measurements and so the measurements in actuality deviate more from the mean than from its estimate. The true  <b>X<sub>center</sub></b> of the underlying random variable will not be perfectly centered and the true standard deviation will always be a bit higher. The correct estimate for <b>&sigma;</b> will be:
</p>
<blockquote>
<p>
&sigma;<sub>best-estimate</sub> = &radic; (1/[N-1]) &sum;(x<sub>i</sub>-X<sub>center</sub>)<sup>2</sup>
</p>
</blockquote>
<p>
Proof of this is ommitted.. but do note that as N gets larger this bias becomes insignificant
</p>
</div>
</div>
</div>

<div id="outline-container-org8cca352" class="outline-3">
<h3 id="org8cca352">SigFigs</h3>
<div class="outline-text-3" id="text-org8cca352">
<p>
We can then use these two descriptive statistics to write out a random variable as a <i>value</i> + <i>standard deviation</i> pair. This is often what you will see on an instrument or quoted in a scientific publication. The underlying probability distribution will often either be infered or, as we'll soon see, will be irrelevant
</p>

<p>
Uncertainties/standard-deviation should typically be one digit. And they should be rounded to be on the order of the significant figure.
</p>
<blockquote>
<p>
2.45 &plusmn; 0.04
</p>
</blockquote>
<p>
When we later see how to estimate these values it'll become clear that it doesn't make much sense to have more digits of precision in your uncertainty than in your expected value. In some cases you may want to leave more sigfigs in the uncertainty like if the number is two significant figures and the first digit is small
</p>
<blockquote>
<p>
1.3 &plusmn; 0.4<br>
1.3 &plusmn; 0.37
</p>
</blockquote>
<p>
You can also express the uncertainty as a a fraction or a percentage. Given an uncertainty
</p>
<blockquote>
<p>
x<sub>0</sub> &plusmn; &delta;x<sub>0</sub>
</p>
</blockquote>
<p>
You would write is as
</p>
<blockquote>
<p>
x<sub>0</sub> with a  [100*&delta;x<sub>0</sub>/x<sub>0</sub>]  percent uncertainty<br>
or<br>
x<sub>0</sub> &plusmn; xx%
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-octave"><span style="color: #a020f0;">function</span> [value<span style="color: #483d8b;">,</span> fractional] <span style="color: #483d8b;">=</span> <span style="color: #0000ff;">uncertainty2fractional</span>(x<span style="color: #483d8b;">,</span> dx)
  value <span style="color: #483d8b;">=</span> x
  fractional <span style="color: #483d8b;">=</span> (dx<span style="color: #483d8b;">/</span>x)
<span style="color: #a020f0;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">[x fx]  <span style="color: #483d8b;">=</span> uncertainty2fractional(50<span style="color: #483d8b;">,</span>25)
ans <span style="color: #483d8b;">=</span> [x fx]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">| 50 | 0.5 |</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave"><span style="color: #a020f0;">function</span> [value<span style="color: #483d8b;">,</span> uncertainty] <span style="color: #483d8b;">=</span> <span style="color: #0000ff;">fractional2uncertainty</span>(x<span style="color: #483d8b;">,</span> fx)
  value <span style="color: #483d8b;">=</span> x
  uncertainty <span style="color: #483d8b;">=</span> x<span style="color: #483d8b;">*</span>fx
<span style="color: #a020f0;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">[x dx]  <span style="color: #483d8b;">=</span> fractional2uncertainty(50<span style="color: #483d8b;">,</span>0.5)
ans <span style="color: #483d8b;">=</span> [x dx]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">| 50 | 25 |</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc86fa4c" class="outline-3">
<h3 id="orgc86fa4c">Adding two random variables</h3>
<div class="outline-text-3" id="text-orgc86fa4c">
<p>
Here we begin to see the utility of <i>descriptive statistics</i>. They don't just serve as a quick summary of the random variable, but are something that can be manipulated directly.
</p>
</div>
<div id="outline-container-orgd71387b" class="outline-4">
<h4 id="orgd71387b">Expected Value</h4>
<div class="outline-text-4" id="text-orgd71387b">
<p>
If we add two random variables <b>z=x+y</b> then, regardless of their underlying probability distributions, their estimated values will add directly.
</p>
<blockquote>
<p>
<b>E[z] = E[x+y] = E[x] + E[y]</b>
</p>
</blockquote>
<p>
This is a consequence of integrals of sums <i>&int;(f(u)&times;u+g(u)&times;u) = &int;f(u)&times;u+&int;g(u)&times;u</i>
</p>
</div>
</div>

<div id="outline-container-org23d4c7d" class="outline-4">
<h4 id="org23d4c7d">Variance</h4>
<div class="outline-text-4" id="text-org23d4c7d">
<p>
The variance will also add directly, irrespective of distribution, as long as <i>a</i> and <i>b</i> are not correlated. To see this, imagine for simplicity that you have two random variables <b>x</b> and <b>y</b> that have an expected value of <b>0</b>.  We will say the random variable <b>z</b> is their sum <b>z=x+y</b>
</p>

<blockquote>
<p>
E[x] = 0 <br>
Var(x) = E[0 - x<sup>2</sup>] = E[x<sup>2</sup>] <br>
E[y] = 0 <br>
Var(y) = E[0 - y<sup>2</sup>] = E[y<sup>2</sup>] <br>
E[z] = E[x] + E[y] = 0 <br>
Var[z]= E[(E[z]-(z))<sup>2</sup>] = E[(0-(x+y))<sup>2</sup>] = E[(x+y)<sup>2</sup>] = E[x<sup>2</sup>+y<sup>2</sup>+xy] = E[x<sup>2</sup>] + E[y<sup>2</sup>] + E[xy]
</p>
</blockquote>

<p>
As long as <i>a</i> and <i>b</i> are uncorrelated, we can split the last term <b>E[xy]</b> into <b>E[x]*E[y]</b> to see that it is equal to <b>0</b> (you can again go back to the integral definition here). So we are left with the fact that the variance of the sum is the sum of the variances
</p>
<blockquote>
<p>
Var[z]= Var[x] + Var[y]
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org3d2e530" class="outline-4">
<h4 id="org3d2e530">Standard Deviation</h4>
<div class="outline-text-4" id="text-org3d2e530">
<p>
This makes the standard deviation the <i>quadrature sum</i> of the two random variables
</p>

<blockquote>
<p>
&sigma;<sub>z</sub> = &radic;[E[x<sup>2</sup>] + E[y<sup>2</sup>]] = &radic;(&sigma;<sub>x</sub><sup>2</sup> + &sigma;<sub>y</sub><sup>2</sup>)
</p>
</blockquote>
</div>
</div>

<div id="outline-container-orgac85597" class="outline-4">
<h4 id="orgac85597">SigFigs</h4>
<div class="outline-text-4" id="text-orgac85597">
<p>
Combining the two, we can now write out the sum of two random variables as:
</p>

<blockquote>
<p>
(x&plusmn;&delta;x) + (y&plusmn;&delta;y) = q&plusmn;&delta;q<br>
q = x+y<br>
&delta;q = &radic;{&delta;x<sup>2</sup>+&delta;y<sup>2</sup>}
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-octave"><span style="color: #a020f0;">function</span> [z<span style="color: #483d8b;">,</span> dz] <span style="color: #483d8b;">=</span> <span style="color: #0000ff;">uncertainSum</span>(x<span style="color: #483d8b;">,</span> dx<span style="color: #483d8b;">,</span> y<span style="color: #483d8b;">,</span> dy)
  z <span style="color: #483d8b;">=</span> x <span style="color: #483d8b;">+</span> y
  dz <span style="color: #483d8b;">=</span> sqrt(dx<span style="color: #483d8b;">^</span>2<span style="color: #483d8b;">+</span>dy<span style="color: #483d8b;">^</span>2)
<span style="color: #a020f0;">end</span>
</pre>
</div>

<div class="org-src-container">
<pre class="src src-octave">[z dz] <span style="color: #483d8b;">=</span> uncertainSum(10<span style="color: #483d8b;">,</span> 1<span style="color: #483d8b;">,</span> 20<span style="color: #483d8b;">,</span> 3)
ans <span style="color: #483d8b;">=</span> [z dz]
</pre>
</div>

<div class="org-src-container">
<pre class="src src-org"><span style="color: #0000ff;">| 30 | 3.16227766016838 |</span>
</pre>
</div>
</div>
</div>

<div id="outline-container-org02141c6" class="outline-4">
<h4 id="org02141c6">Example: Standard deviation of the mean (SDOM)</h4>
<div class="outline-text-4" id="text-org02141c6">
<p>
Using these new properties we can now calculate how accurate our previous estimate for the mean was. The estimate was to add up the measurements and then divide by the total number of them:
</p>

<blockquote>
<p>
 X<sub>center</sub> = &sum;x<sub>i</sub>/N <br>
= x<sub>0</sub>/N + x<sub>1</sub>/N + x<sub>2</sub>/N + &hellip;
</p>
</blockquote>

<p>
We know each measurement comes from a random variable of mean <b>X<sub>center</sub></b> and standard deviation <b>&sigma;<sub>x</sub></b> so we can write it out using our previous notation
</p>
<blockquote>
<p>
= (X<sub>center</sub>&plusmn;&sigma;<sub>X</sub>)/N + (X<sub>center</sub>&plusmn;&sigma;<sub>X</sub>)/N + (X<sub>center</sub>&plusmn;&sigma;<sub>X</sub>)/N + &hellip; <br>
= (X<sub>center</sub>/N&plusmn;&sigma;<sub>X</sub>/N) + (X<sub>center</sub>/N&plusmn;&sigma;<sub>X</sub>/N) + (X<sub>center</sub>/N&plusmn;&sigma;<sub>X</sub>/N) + &hellip;
</p>
</blockquote>

<p>
So now we just need to do a quadrature sum of these deviations to get a total deviation:
</p>

<blockquote>
<p>
&sigma;<sub>X<sub>center</sub></sub> = &radic; &sum; [ (&sigma;<sub>x</sub>/N)<sup>2</sup> + (&sigma;<sub>x</sub>/N)<sup>2</sup> + (&sigma;<sub>x</sub>/N)<sup>2</sup> + &hellip; ] <br>
= &radic;[N &times; (&sigma;<sub>x</sub>/N)<sup>2</sup> ] <br>
= &radic;[&sigma;<sub>x</sub><sup>2</sup>/N ] <br>
= &sigma;<sub>x</sub>/&radic;N
</p>
</blockquote>
<p>
In some situations this can provide a useful error. Particularly if you have a noisy method of measurement but the thing you are measuring is pretty constant. For instance if you're measuring a resistor. The resistor is of a constant value and doesn't fluctuate, but your voltmeter/power source will have some error
</p>
<blockquote>
<p>
<b>Side note..</b> : the uncertainty in <b>&sigma;<sub>x</sub></b> is: <b>1 /&radic;[2(N-1)] <br>
</b>
<i>Proof omitted for now..</i>
</p>
</blockquote>
</div>
</div>
</div>
<div id="outline-container-org03fa617" class="outline-3">
<h3 id="org03fa617">Multiplying two random variables</h3>
<div class="outline-text-3" id="text-org03fa617">
<p>
Again, we work directly with the descriptive statistics without even looking at the variables' PDFs
</p>
</div>
<div id="outline-container-orgb3fd825" class="outline-4">
<h4 id="orgb3fd825">Expected Value</h4>
<div class="outline-text-4" id="text-orgb3fd825">
<blockquote>
<p>
E[z] = E[x] &times; E[y]
</p>
</blockquote>
</div>
</div>
<div id="outline-container-orge9fc430" class="outline-4">
<h4 id="orge9fc430">Variance</h4>
<div class="outline-text-4" id="text-orge9fc430">
<p>
We start directly with directly applying the equation for the variance
</p>
<blockquote>
<p>
Var(xy) = E[(xy-XY)<sup>2</sup>] &hellip;
</p>
</blockquote>
<p>
<b>X</b> and <b>Y</b> are short hand for <b>E[x]</b> and <b>E[y]</b>
</p>

<p>
First we focus on massaging the inner term <b>xy-XY</b>
</p>
<blockquote>
<p>
XY &times; [x/X &times; y/Y -1] <br>
XY &times; [ ([x-X]/X + 1) &times; ([y-Y]/Y + 1)  - 1 ] <br>
XY &times; [ [x-X]/X + [y-Y]/Y + [x-X]&times;[y-Y]/XY ]
</p>
</blockquote>
<p>
if <b>&delta;x = [x-X]/X</b> and <b>&delta;y = [y - Y]/Y</b>, then we can rewrite this as
</p>
<blockquote>
<p>
XY &times; [&delta;x+&delta;y+ &delta;x&delta;y]
</p>
</blockquote>
<p>
So now we can rewrite the original equation
</p>
<blockquote>
<p>
Var(xy) = E[(xy-XY)<sup>2</sup>] <br>
= (XY)<sup>2</sup> &times; E[(&delta;x + &delta;y + &delta;x&delta;y)<sup>2</sup>] <br>
= (XY)<sup>2</sup> &times; E[&delta;x<sup>2</sup> + &delta;x&delta;y + &delta;x<sup>2</sup>&delta;y + &delta;y&delta;x + &delta;y<sup>2</sup> + &delta;x&delta;y<sup>2</sup> + &delta;x<sup>2</sup>&delta;y + &delta;x&delta;y<sup>2</sup> + &delta;x<sup>2</sup>&delta;y<sup>2</sup>] <br>
= (XY)<sup>2</sup> &times; (E[&delta;x<sup>2</sup>] + E[&delta;x&delta;y] + E[&delta;x<sup>2</sup>&delta;y] + E[&delta;y&delta;x] + E[&delta;y<sup>2</sup>] + E[&delta;x&delta;y<sup>2</sup>] + E[&delta;x<sup>2</sup>&delta;y] + E[&delta;x&delta;y<sup>2</sup>] + E[&delta;x<sup>2</sup>&delta;y<sup>2</sup>]) <br>
</p>
</blockquote>
<p>
Not mentioned explicitely till now, but when we have want to find the <i>expected value</i> of a equation of multiple random variables  we need to integrate across all variables. So in this case we want to integrate across <b>x</b> and <b>y</b> from -&infin; to &infin;. As premised at the beginning, <b>x</b> and <b>y</b> are independent, so when we write out these expected values we can actually rearrange them as each integral is independent (the other terms is treated as a constant in each integral). 
</p>

<blockquote>
<p>
E[x<sup>n</sup>y<sup>m</sup>] = &int;<sub>x</sub>&int;<sub>y</sub>x<sup>n</sup>y<sup>m</sup><br>
E[x<sup>n</sup>y<sup>m</sup>] = &int;<sub>x</sub>x<sup>n</sup>&int;<sub>y</sub>y<sup>m</sup>
</p>
</blockquote>
<p>
The final trick is to notice that <b>&delta;x</b> and <b>&delta;y</b> have an expected values are <i>zero</i> - so if either <b>m</b> or <b>n</b> are equal to <b>1</b> then it's integral goes to zero and so <b>E[x<sup>n</sup>y<sup>m</sup>]</b> comes out to <b>0</b>. The only nonzero terms that remain are
</p>
<blockquote>
<p>
= (XY)<sup>2</sup> &times; (E[&delta;x<sup>2</sup>] + E[&delta;y<sup>2</sup>] + E[(&delta;x&delta;y)<sup>2</sup>]) <br>
</p>
</blockquote>
<blockquote>
<p>
= (XY)<sup>2</sup> &times; (V[x]/X<sup>2</sup> + V[y]/Y<sup>2</sup> + V[x]V[y]/(XY)<sup>2</sup>) <br>
= Y<sup>2</sup>V[x] + X<sup>2</sup>V[y] + V[x]V[y] <br>
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org0f8a4db" class="outline-4">
<h4 id="org0f8a4db">Standard Deviation</h4>
<div class="outline-text-4" id="text-org0f8a4db">
<p>
The standard deviation is the square root of the variance.. 
</p>
<blockquote>
<p>
&sigma;<sub>xy</sub> &cong; &radic; [Y<sup>2</sup>V[x] + X<sup>2</sup>V[y] + V[x]V[y]]
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org9740439" class="outline-4">
<h4 id="org9740439">SigFigs</h4>
<div class="outline-text-4" id="text-org9740439">
<p>
Again, summarizing in our standard notation we get
</p>
<blockquote>
<p>
(x&plusmn;&delta;x) &times; (y&plusmn;&delta;y) = q&plusmn;&delta;q<br>
q = x&times;y<br>
&delta;q/q = &radic;[x<sup>2</sup>&delta;y<sup>2</sup> + y<sup>2</sup>&delta;x<sup>2</sup> + &delta;x<sup>2</sup>&delta;y<sup>2</sup>]
</p>
</blockquote>

<div class="org-src-container">
<pre class="src src-octave"><span style="color: #a020f0;">function</span> [z<span style="color: #483d8b;">,</span> dz] <span style="color: #483d8b;">=</span> <span style="color: #0000ff;">uncertainProduct</span>(x<span style="color: #483d8b;">,</span> dx<span style="color: #483d8b;">,</span> y<span style="color: #483d8b;">,</span> dy)
  z <span style="color: #483d8b;">=</span> x<span style="color: #483d8b;">*</span>y
  dz <span style="color: #483d8b;">=</span> sqrt(x<span style="color: #483d8b;">^</span>2<span style="color: #483d8b;">*</span>dy<span style="color: #483d8b;">^</span>2 <span style="color: #483d8b;">+</span> y<span style="color: #483d8b;">^</span>2<span style="color: #483d8b;">*</span>dx<span style="color: #483d8b;">^</span>2 <span style="color: #483d8b;">+</span> dx<span style="color: #483d8b;">^</span>2<span style="color: #483d8b;">*</span>dy<span style="color: #483d8b;">^</span>2)
<span style="color: #a020f0;">end</span>
</pre>
</div>
</div>
</div>
</div>
</div>

<div id="outline-container-org7da44e5" class="outline-2">
<h2 id="org7da44e5">Other Topics</h2>
<div class="outline-text-2" id="text-org7da44e5">
</div>
<div id="outline-container-orgc3edccf" class="outline-3">
<h3 id="orgc3edccf">Data Rejection</h3>
<div class="outline-text-3" id="text-orgc3edccf">
<p>
Sometimes things go wrong and data is just way out there
</p>
</div>
<div id="outline-container-org1d95328" class="outline-4">
<h4 id="org1d95328">Chauvenet's Criterion</h4>
<div class="outline-text-4" id="text-org1d95328">
<p>
This is a scheme for rejecting data - but it only makes sense if your data is normally distributed
You first find how many standard deviation this measurement is away from your estimated mean
</p>
<blockquote>
<p>
t<sub>sus</sub> = |x<sub>sus</sub> - X<sub>center</sub>|/&sigma;<sub>x</sub>
</p>
</blockquote>
<p>
Then you look up the probability a measurement is that far off in a table. This probability represents the fraction of points that will lie either at the point in question or further out. Multiply it times the amount of measurements you've done, <b>N</b>,  and you get the amount of points you'd expect to lie at the point-or-further after <b>N</b> measurements.
</p>
<blockquote>
<p>
N &times; Prob(outside t<sub>sus</sub>&sigma;)
</p>
</blockquote>
<p>
If the value is smaller than <b>1/2</b> then we expect less tan half a point out as far as the point in question - so you can reject the point and recalculate your mean/sigma.
</p>
</div>
</div>
</div>
<div id="outline-container-orgd03facd" class="outline-3">
<h3 id="orgd03facd">Weighted Average</h3>
<div class="outline-text-3" id="text-orgd03facd">
<p>
We often want to average different measurements into one. It's clear a measurement with a larger error should have a smaller effect on the outcome than a measurement with a smaller error. 
</p>
</div>
<div id="outline-container-orgcc7c661" class="outline-4">
<h4 id="orgcc7c661">Mean</h4>
<div class="outline-text-4" id="text-orgcc7c661">
<p>
To get the combined mean we proceed in a direct manner. We multiply the two PDFs and minimize the result
</p>
<blockquote>
<p>
pdf(x<sub>a</sub>) = (1/(&sigma;<sub>a</sub>&radic;2&pi;))  e<sup>(x<sub>a</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>a</sub><sup>2</sup>)</sup><br>
pdf(x<sub>b</sub>) = (1/(&sigma;<sub>b</sub>&radic;2&pi;))  e<sup>(x<sub>b</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>b</sub><sup>2</sup>)</sup><br>
</p>
</blockquote>
<p>
Here <b>x<sub>a</sub></b> and <b>x<sub>b</sub></b> are the two prior measurements/estimates we have, and the <b>X<sub>center</sub></b> will be our combined average mean. We need to choose an  <b>X<sub>center</sub></b> that will maximize the probability of both functions. We combine probabilities by multiplication
</p>
<blockquote>
<p>
pdf(x<sub>a</sub>) &times; pdf(x<sub>b</sub>) <br>
(1/(&sigma;<sub>a</sub>&radic;2&pi;))  e<sup>(x<sub>a</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>a</sub><sup>2</sup>)</sup> &times; (1/(&sigma;<sub>b</sub>&radic;2&pi;))  e<sup>(x<sub>b</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>b</sub><sup>2</sup>)</sup> <br>
(1/(&sigma;<sub>a</sub>&sigma;<sub>b</sub>2&pi;)) e<sup>(x<sub>a</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>a</sub><sup>2</sup>) + (x<sub>b</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>b</sub><sup>2</sup>)</sup> <br>
</p>
</blockquote>
<p>
Again here we just care to maximize the exponent (the only part that's a function of <b>X<sub>center</sub></b>). We take its derivative and set to zero
</p>
<blockquote>
<p>
0 = d/dX (x<sub>a</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>a</sub><sup>2</sup>) + (x<sub>b</sub>-X<sub>center</sub>)<sup>2</sup>/(2&sigma;<sub>b</sub><sup>2</sup>)<br>
0 = (x<sub>a</sub>-X<sub>center</sub>)/&sigma;<sub>a</sub><sup>2</sup> + (x<sub>b</sub>-X<sub>center</sub>)/&sigma;<sub>b</sub><sup>2</sup> <br>
X<sub>center</sub> = [x<sub>a</sub>/&sigma;<sub>a</sub><sup>2</sup> + x<sub>b</sub>/&sigma;<sub>b</sub><sup>2</sup>] / [(1/&sigma;<sub>a</sub><sup>2</sup> + 1/&sigma;<sub>b</sub><sup>2</sup>]
</p>
</blockquote>
<p>
You can also rewrite this by introducing a new variable called a <b>weight</b>
</p>
<blockquote>
<p>
w = 1/&sigma;<sup>2</sup>
</p>
</blockquote>
</div>
</div>
<div id="outline-container-org97c2257" class="outline-4">
<h4 id="org97c2257">Standard Deviation</h4>
<div class="outline-text-4" id="text-org97c2257">
<p>
The standard deviation we derive from the equation for the mean by applying error propagation.
The simplifying trick is to first look at the variance of the sum: <b>Var[z]= Var[x] + Var[y]</b>. 
If you immediately try to calculate standard deviation and use the quadrature rule then things get overly complicated
(as a general rule, it's easier to deal with variances b/c you avoid the quadrature mathematical mess)
</p>
<blockquote>
<p>
X<sub>center</sub> = [x<sub>a</sub>/&sigma;<sub>a</sub><sup>2</sup> + x<sub>b</sub>/&sigma;<sub>b</sub><sup>2</sup>] / [(1/&sigma;<sub>a</sub><sup>2</sup> + 1/&sigma;<sub>b</sub><sup>2</sup>] <br>
Var[center] = Var[x<sub>a</sub>]/[&sigma;<sub>a</sub><sup>2</sup> + Var[x<sub>b</sub>]/[&sigma;<sub>b</sub><sup>2</sup> / [(1/&sigma;<sub>a</sub><sup>2</sup> + 1/&sigma;<sub>b</sub><sup>2</sup>]
</p>
</blockquote>
<p>
Since <b>Var[w] = &sigma;<sub>w</sub><sup>2</sup></b>, the top terms all cancel out and you're left with the bottom term only
</p>
<blockquote>
<p>
Var[center] = 1 / [(1/&sigma;<sub>a</sub><sup>2</sup> + 1/&sigma;<sub>b</sub><sup>2</sup>] <br>
&sigma;<sub>center</sub> = 1 / &radic;[(1/&sigma;<sub>a</sub><sup>2</sup> + 1/&sigma;<sub>b</sub><sup>2</sup>]
</p>
</blockquote>
</div>
</div>
</div>
</div>
<div id="outline-container-orgeae5882" class="outline-2">
<h2 id="orgeae5882">End</h2>
</div>
</div>
</body>
</html>
